<!-- Code here is used to build the map by google-maps-for-rails-->
<div class="container" id="gmap">
  <div class="col-md-10 padding-resize" id="agency-lookup">
    <h1 id="organizations"><%= (t'footer.organizations')%></h1>
    <div class="">
      <!-- button -->
      <div class="col-md-pull-4">
          <div class="map-responsive" id="index-map" style='width: 100%; height: 350%;'></div>
      </div>
      <div class="padding-resize">

      </br>
      <div class="flex-row row">
      <%= render 'agency', obj: @agencies %>
      </div>

      <!-- end ul col-md-12 -->
      <div class="center">
        <%#= will_paginate %>
      </div>
      <%# render 'agency', obj: @agencies %>
      <div class="center">
        <%#= will_paginate %>
      </div>
      </div>
      <%#end panel-body%>
    </div>
    <%#end panel%>
  </div>
  <%# end col-md-9%>
</div>

<script type="text/javascript">
$(function() {
  $('.show-map').click(function(event){
    event.preventDefault();
    $('div#index-map').toggle();
    handler = Gmaps.build('Google');
    handler.buildMap({
      provider: {},
      internal: {
        id: 'index-map'
      }
    }, function () {
      google.maps.event.trigger(handler, 'resize');
      markers = handler.addMarkers(<%=raw @hash.to_json %>);
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();

    });
  });
});
</script>
