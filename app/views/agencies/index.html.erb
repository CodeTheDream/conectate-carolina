<% content_for :title do %><%=  (t'nav_links.home') %> | Conectate Carolina<% end %>

<script src="//maps.google.com/maps/api/js?key=AIzaSyCj5WxwF7qYcjlvsjtzabyVi0Se1WtuA6w"></script>
<script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
<script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script>
<!-- only if you need custom infoboxes -->
<!-- Script is used to connect to Google API, This nees to be moved to a better location
 since it has been copied in index and show view -JR -->

<script>

var x = document.getElementById("location");
function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
    } else {
        x.innerHTML = "Geolocation is not supported by this browser.";
    }
}
function showPosition(position) {
	var x = document.getElementById("coordinates");
    x.value = position.coords.latitude + "," + position.coords.longitude;
    console.log(x.value)
}
getLocation();
</script>
<section class="top-background">
  <div class="header">

  <h1><%= (t'home_page.title') %></h1>
  <h2><%= (t'home_page.browse') %></h2>
    <div class="wrapper">
      <%= form_tag agencies_path(anchor: "organizations"), method: :get, class: 'form-group row', id: 'agency-lookup-form', data: { behaviors: 'turboform' } do %>
        <div class="col-md-5">

          <%= text_field_tag :search, params[:search], placeholder: (t'search_page.plchldr_search'), :class => 'form-control', autofocus: params[:search].present? %>

        </div>

        <div class="col-md-5">
          <%= text_field_tag :location, params[:location], placeholder: (t'home_page.location'), :class => 'form-control', autofocus: params[:location].present? %>
          <%= hidden_field_tag :coordinates, params[:coordinates]%>

          <!-- <%= text_field_tag :location, params[:location], placeholder: "search by location", :class => 'form-control search-input', autofocus: params[:location].present? %> -->

        </div>
        <div class="container">
        <% search_spinner = "<i class='fa fa-spinner fa-spin'></i> Searching..." %>
        <span class="input-group-btn">
          <%= button_tag( type: "submit", class: "btn btn-primary", :name => nil,
          data: {disable_with: search_spinner }) do %>
          <span class="glyphicon glyphicon-search"></span>
          <%= (t'search_page.bttn_search') %>
          <% end %>
          </span>

      </div>
      <% end %>
    </div>
  </div>
</section>

<div class="row row-centered agencies-body">
  <%= render 'sidebar' %>
  <!-- end col-md-3 sidebar-->
  <%= render 'agencies' %>
</div>
<%#end row %>
